<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Melt (Convert) an Object of Class 'mefa' Into 'stcs' — melt • mefa</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Melt (Convert) an Object of Class 'mefa' Into 'stcs' — melt" />
<meta property="og:description" content="The function converts a wide formatted 'mefa' object into a long formatted 'stcs' object. The resulting segment column can take various formats." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55877016-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55877016-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mefa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/psolymos/mefa/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Melt (Convert) an Object of Class 'mefa' Into 'stcs'</h1>
    
    <div class="hidden name"><code>melt.mefa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function converts a wide formatted 'mefa' object into a long formatted 'stcs' object. The resulting segment column can take various formats.</p>
    </div>

    <pre class="usage"><span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for mefa</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, segm.var <span class='op'>=</span> <span class='cn'>NULL</span>, by.samp <span class='op'>=</span> <span class='cn'>TRUE</span>,
raw.out <span class='op'>=</span> <span class='cn'>FALSE</span>, drop.zero <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of class 'mefa'.</p></td>
    </tr>
    <tr>
      <th>segm.var</th>
      <td><p><code>NULL</code> (default) or column indices of samples (if <code>by.samp = TRUE</code>) or taxa tables (if <code>by.samp = FALSE</code>). If it refers to more than one column, their interaction is taken. If <code>NULL</code>, the resulting segment column is filled with <code>"undefined"</code>.</p></td>
    </tr>
    <tr>
      <th>by.samp</th>
      <td><p>logical, if <code>TRUE</code> (default) <code>segm.var</code> is taken from the samples table (<code>x$samp</code>), if <code>FALSE</code> <code>segm.var</code> is taken from the taxa table (<code>x$taxa</code>).</p></td>
    </tr>
    <tr>
      <th>raw.out</th>
      <td><p>logical, whether the result should contain all the zeros that is in the crosstabulated (wide) matrix (<code>TRUE</code>) or not (<code>FALSE</code>, default). Removing the zeros is straightforward for sparse matrices. But empty samples can be retained if <code>drop.zero = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>drop.zero</th>
      <td><p>logical, whether samples with zero total count should be leaved out (<code>TRUE</code>) or not (<code>FALSE</code>, default).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed to the function <code><a href='stcs.html'>stcs</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If a 'mefa' objet has original segments and <code>segm.var = NULL</code>, the function returns original segments. In this case, the <code>raw.out = TRUE</code> cannot be applied (because segments have different zero samples, so the option is meaningless). If the 'mefa' object contains only a data matrix without dimnames, rows and columns are numbered before melting.</p>
<p>Besides the goal to convert from wide format to long format, this 'mefa' specific implementation is also useful, if a segment is not coded along with the long formatted database, but can be found in a linked table of samples or species. In this way, a 'mefa' object with new segments can be defined easily.</p>
<p>If melting is done with a vector that is not part of the tables inside the 'mefa' object, it must have a class attribute to be recognised, use e.g. the <code><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></code> function (see 'Examples').</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class 'stsc' if <code>raw = FALSE</code>, pure 'data.frame' otherwise (because the zero count flag cannot be applied).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125--127.</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1--28. doi: <a href='https://doi.org/10.18637/jss.v029.i08'>10.18637/jss.v029.i08</a></p>
<p><a href='http://mefa.r-forge.r-project.org/'>http://mefa.r-forge.r-project.org/</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>P\'eter S\'olymos, <a href='mailto:solymos@ualberta.ca'>solymos@ualberta.ca</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The generic function <code>melt</code> can also be found in the <strong>reshape</strong> package of Hadley Wickham, along with methods for data frames, arrays and lists (<code><a href='https://rdrr.io/pkg/reshape/man/melt-default-gi.html'>melt.default</a></code>, <code><a href='https://rdrr.io/pkg/reshape/man/melt-data-frame-da.html'>melt.data.frame</a></code>, <code><a href='https://rdrr.io/pkg/reshape/man/melt-array-e0.html'>melt.array</a></code>).</p>
<p>Similar function in the <strong>Hmisc</strong> package by Frank Harrel is the <code><a href='https://rdrr.io/pkg/Hmisc/man/reShape.html'>reShape</a></code>.</p>
<p>Similar function in the <strong>simba</strong> package by  Gerald Jurasinski is the <code><a href='https://rdrr.io/pkg/simba/man/liste.html'>liste</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>dol.count</span>, <span class='va'>dol.samp</span>, <span class='va'>dol.taxa</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mefa.html'>mefa</a></span><span class='op'>(</span><span class='fu'><a href='stcs.html'>stcs</a></span><span class='op'>(</span><span class='va'>dol.count</span><span class='op'>)</span>, <span class='va'>dol.samp</span>, <span class='va'>dol.taxa</span><span class='op'>)</span>
<span class='co'>## Long format with original segments</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa count        segm
#&gt; 1    DQ1        amin     2      broken
#&gt; 2    DQ1        amin     2       fresh
#&gt; 3    DQ1        ctri     2       fresh
#&gt; 4    DQ1        dper     2       fresh
#&gt; 5    DQ1        estr     1       fresh
#&gt; 6    DQ1        vidi     2      broken
#&gt; 7    DQ1        vidi     7       fresh
#&gt; 8    DQ2        amin     1      broken
#&gt; 9    DQ2        amin     3       fresh
#&gt; 10   DQ2        apur     1      broken
#&gt; 11   DQ2        ctri     7      broken
#&gt; 12   DQ2        ctri    13       fresh
#&gt; 13   DQ2        dper     1      broken
#&gt; 14   DQ2        dper     1       fresh
#&gt; 15   DQ2        druf     1      broken
#&gt; 16   DQ2        druf     1       fresh
#&gt; 17   DQ2        ppyg     1      broken
#&gt; 18   DQ2        vidi     4      broken
#&gt; 19   DQ2        vidi     5       fresh
#&gt; 20   DQ3        amin     1      broken
#&gt; 21   DQ3        amin     2       fresh
#&gt; 22   DQ3        apur     1       fresh
#&gt; 23   DQ3        hobv     3      broken
#&gt; 24   DQ3        vidi     2      broken
#&gt; 25   DT1        amin     1       fresh
#&gt; 26   DT1        dper     1       fresh
#&gt; 27   DT1        estr     1      broken
#&gt; 28   DT1        hobv     1       fresh
#&gt; 29   DT1        mbor     5       fresh
#&gt; 30   DT1        pvic     1       fresh
#&gt; 31   DT1        bcan     1      broken
#&gt; 32   DT2        amin     2       fresh
#&gt; 33   DT2        apur     1       fresh
#&gt; 34   DT2        bbip     1       fresh
#&gt; 35   DT2        clam     2       fresh
#&gt; 36   DT2        dper     1       fresh
#&gt; 37   DT2        druf     1       fresh
#&gt; 38   DT2        estr     1      broken
#&gt; 39   DT2        hobv     1       fresh
#&gt; 40   DT2        tuni     1       fresh
#&gt; 41   DT2        vidi     2       fresh
#&gt; 42   DT3        amin     3       fresh
#&gt; 43   DT3        bbip     1      broken
#&gt; 44   DT3        hobv     1      broken
#&gt; 45   DT3        hobv     5       fresh
#&gt; 46   DT3        pvic     1       fresh
#&gt; 47   DT3        vidi     2       fresh
#&gt; 48   LQ1        aacu     1       fresh
#&gt; 49   LQ1        amin     1      broken
#&gt; 50   LQ1        amin     2       fresh
#&gt; 51   LQ1        dper     1      broken
#&gt; 52   LQ1        ffau     1      broken
#&gt; 53   LQ1        ppyg    13       fresh
#&gt; 54   LQ1        ppyg    15      broken
#&gt; 55   LQ2        aacu     1       fresh
#&gt; 56   LQ2        amin     1      broken
#&gt; 57   LQ2        dper     1       fresh
#&gt; 58   LQ2        ppyg     5       fresh
#&gt; 59   LQ2        ppyg     8      broken
#&gt; 60   LQ2        pvic     1      broken
#&gt; 61   LQ3        amin     2      broken
#&gt; 62   LQ3        apur     1       fresh
#&gt; 63   LQ3        bbip     1      broken
#&gt; 64   LQ3        ccer     1      broken
#&gt; 65   LQ3        dper     1      broken
#&gt; 66   LQ3        dper     6       fresh
#&gt; 67   LQ3        ppyg    33      broken
#&gt; 68   LQ3        ppyg    36       fresh
#&gt; 69   LQ3        pvic     1      broken
#&gt; 70   LT2        amin     1       fresh
#&gt; 71   LT2        pvic     1      broken
#&gt; 72   LT3        amin     5       fresh
#&gt; 73   LT3        dper     1       fresh
#&gt; 74   LT3        pinc     1       fresh
#&gt; 75   LT3        pvic     1       fresh
#&gt; 76   LT3        tuni     1      broken
#&gt; 77   LT3        tuni     1       fresh
#&gt; 78   RQ1        amin     1      broken
#&gt; 79   RQ1        amin     2       fresh
#&gt; 80   RQ1        ccer     1      broken
#&gt; 81   RQ1        clam     1       fresh
#&gt; 82   RQ1        cort     1       fresh
#&gt; 83   RQ1        dper     1      broken
#&gt; 84   RQ1        dper     2       fresh
#&gt; 85   RQ1        ffau     2      broken
#&gt; 86   RQ1        hobv     2       fresh
#&gt; 87   RQ1        ogla     1      broken
#&gt; 88   RQ1        ppyg     1      broken
#&gt; 89   RQ1        ppyg     4       fresh
#&gt; 90   RQ1        vidi     1       fresh
#&gt; 91   RQ1        vidi     3      broken
#&gt; 92   RQ2        amin     7       fresh
#&gt; 93   RQ2        bbip     2      broken
#&gt; 94   RQ2        bbip     2       fresh
#&gt; 95   RQ2        ctri     3      broken
#&gt; 96   RQ2        ctri     4       fresh
#&gt; 97   RQ2        dbre     1      broken
#&gt; 98   RQ2        dper     2      broken
#&gt; 99   RQ2        dper     4       fresh
#&gt; 100  RQ2        estr     3       fresh
#&gt; 101  RQ2        ffau     1      broken
#&gt; 102  RQ2        ffau     1       fresh
#&gt; 103  RQ2        hobv     9       fresh
#&gt; 104  RQ2        mobs     2       fresh
#&gt; 105  RQ2        odol     4      broken
#&gt; 106  RQ2        odol     9       fresh
#&gt; 107  RQ2        ogla     1      broken
#&gt; 108  RQ2        ogla     2       fresh
#&gt; 109  RQ2        ppyg     9      broken
#&gt; 110  RQ2        ppyg    19       fresh
#&gt; 111  RQ2        pvic     1      broken
#&gt; 112  RQ2        tuni     2       fresh
#&gt; 113  RQ2        vcos     2       fresh
#&gt; 114  RQ2        vidi     7       fresh
#&gt; 115  RQ3        aacu     2      broken
#&gt; 116  RQ3        amin     6      broken
#&gt; 117  RQ3        amin     7       fresh
#&gt; 118  RQ3        bbip     1      broken
#&gt; 119  RQ3        ctri     2      broken
#&gt; 120  RQ3        ctri     8       fresh
#&gt; 121  RQ3        dbre     3       fresh
#&gt; 122  RQ3        dper     3      broken
#&gt; 123  RQ3        dper     3       fresh
#&gt; 124  RQ3        eful     1      broken
#&gt; 125  RQ3        eful     1       fresh
#&gt; 126  RQ3        ffau     2      broken
#&gt; 127  RQ3        hobv     1      broken
#&gt; 128  RQ3        hobv     1       fresh
#&gt; 129  RQ3        mobs     1      broken
#&gt; 130  RQ3        ppyg     4       fresh
#&gt; 131  RQ3        ppyg     5      broken
#&gt; 132  RQ3        pvic     1      broken
#&gt; 133  RQ3        vidi     4      broken
#&gt; 134  RQ3        vidi     7       fresh
#&gt; 135  RT1        amin     1       fresh
#&gt; 136  RT1        amin     3      broken
#&gt; 137  RT1        bbip     3      broken
#&gt; 138  RT1        ccer     1      broken
#&gt; 139  RT1        ccer     1       fresh
#&gt; 140  RT1        cort     1      broken
#&gt; 141  RT1        dper     1       fresh
#&gt; 142  RT1        ffau     2       fresh
#&gt; 143  RT1        ffau     5      broken
#&gt; 144  RT1        hobv     1       fresh
#&gt; 145  RT1        hobv     7      broken
#&gt; 146  RT1        iiso     6      broken
#&gt; 147  RT1        pinc     1       fresh
#&gt; 148  RT1        pinc     2      broken
#&gt; 149  RT1        pvic     1       fresh
#&gt; 150  RT1        pvic     3      broken
#&gt; 151  RT1        tuni     1       fresh
#&gt; 152  RT1        tuni     4      broken
#&gt; 153  RT2        amin     1      broken
#&gt; 154  RT2        apur     2      broken
#&gt; 155  RT2        bbip     1       fresh
#&gt; 156  RT2        bbip     2      broken
#&gt; 157  RT2        cort     1      broken
#&gt; 158  RT2        ctri     1       fresh
#&gt; 159  RT2        dper     2       fresh
#&gt; 160  RT2        estr     1       fresh
#&gt; 161  RT2        estr     3      broken
#&gt; 162  RT2        ffau     1       fresh
#&gt; 163  RT2        ffau    11      broken
#&gt; 164  RT2        hobv     1      broken
#&gt; 165  RT2        iiso     8      broken
#&gt; 166  RT2        pinc     1       fresh
#&gt; 167  RT2        pinc     4      broken
#&gt; 168  RT2        pvic     1      broken
#&gt; 169  RT2        tuni     1       fresh
#&gt; 170  RT2        tuni     2      broken
#&gt; 171  RT2        vidi     1      broken
#&gt; 172  RT2        vidi     1       fresh
#&gt; 173  RT2        bcan     1      broken
#&gt; 174  RT3        amin     1      broken
#&gt; 175  RT3        amin     4       fresh
#&gt; 176  RT3        apur     1      broken
#&gt; 177  RT3        bbip     5       fresh
#&gt; 178  RT3        clam     1      broken
#&gt; 179  RT3        ffau     3      broken
#&gt; 180  RT3        ffau     3       fresh
#&gt; 181  RT3        hobv     1      broken
#&gt; 182  RT3        hobv     3       fresh
#&gt; 183  RT3        iiso     1       fresh
#&gt; 184  RT3        pinc     3      broken
#&gt; 185  RT3        pvic     1       fresh
#&gt; 186  RT3        pvic     2      broken
#&gt; 187  RT3        tuni     1      broken
#&gt; 188  WQ1        amin     1      broken
#&gt; 189  WQ1        amin     2       fresh
#&gt; 190  WQ1        bbip     1      broken
#&gt; 191  WQ1        cort     3      broken
#&gt; 192  WQ1        iiso     2       fresh
#&gt; 193  WQ1        pinc     2       fresh
#&gt; 194  WQ1        ppyg    11       fresh
#&gt; 195  WQ1        ppyg    20      broken
#&gt; 196  WQ1        pvic     1      broken
#&gt; 197  WQ1        vidi     2      broken
#&gt; 198  WQ1        vidi     2       fresh
#&gt; 199  WQ1        bcan     1      broken
#&gt; 200  WQ2        amin     1       fresh
#&gt; 201  WQ2        amin     3      broken
#&gt; 202  WQ2        bbip     1      broken
#&gt; 203  WQ2        ccer     1       fresh
#&gt; 204  WQ2        dper     5      broken
#&gt; 205  WQ2        dper    15       fresh
#&gt; 206  WQ2        estr     2      broken
#&gt; 207  WQ2        mobs     2      broken
#&gt; 208  WQ2        pinc     1       fresh
#&gt; 209  WQ2        ppyg    27       fresh
#&gt; 210  WQ2        ppyg    29      broken
#&gt; 211  WQ2        pvic     1       fresh
#&gt; 212  WQ2        tuni     2       fresh
#&gt; 213  WQ3        amin     3      broken
#&gt; 214  WQ3        amin     7       fresh
#&gt; 215  WQ3        bbip     1      broken
#&gt; 216  WQ3        bbip     2       fresh
#&gt; 217  WQ3        estr     1      broken
#&gt; 218  WQ3        ffau     2      broken
#&gt; 219  WQ3        pinc     1       fresh
#&gt; 220  WQ3        ppyg     2      broken
#&gt; 221  WQ3        ppyg     3       fresh
#&gt; 222  WQ3        vicr     1       fresh
#&gt; 223  WQ3        vidi     1      broken
#&gt; 224  WT1        amin     1      broken
#&gt; 225  WT1        cort     1       fresh
#&gt; 226  WT1        estr     1      broken
#&gt; 227  WT1        ffau     1       fresh
#&gt; 228  WT1        tuni     1       fresh
#&gt; 229  WT2        amin     2       fresh
#&gt; 230  WT2        apur     1       fresh
#&gt; 231  WT2        bbip     1      broken
#&gt; 232  WT2        dper     2       fresh
#&gt; 233  WT3        amin     4      broken
#&gt; 234  WT3        ffau     1      broken
#&gt; 235  WT3        vidi     1       fresh
#&gt; 236  LT1 zero.pseudo     0 zero.pseudo</div><div class='input'><span class='co'>## Long format with undefined segment</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='fu'><a href='as.mefa.html'>as.mefa</a></span><span class='op'>(</span><span class='va'>x</span>, segment <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa count        segm
#&gt; 1    DQ1        amin     4   undefined
#&gt; 2    DQ1        ctri     2   undefined
#&gt; 3    DQ1        dper     2   undefined
#&gt; 4    DQ1        estr     1   undefined
#&gt; 5    DQ1        vidi     9   undefined
#&gt; 6    DQ2        amin     4   undefined
#&gt; 7    DQ2        apur     1   undefined
#&gt; 8    DQ2        ctri    20   undefined
#&gt; 9    DQ2        dper     2   undefined
#&gt; 10   DQ2        druf     2   undefined
#&gt; 11   DQ2        ppyg     1   undefined
#&gt; 12   DQ2        vidi     9   undefined
#&gt; 13   DQ3        amin     3   undefined
#&gt; 14   DQ3        apur     1   undefined
#&gt; 15   DQ3        hobv     3   undefined
#&gt; 16   DQ3        vidi     2   undefined
#&gt; 17   DT1        amin     1   undefined
#&gt; 18   DT1        bcan     1   undefined
#&gt; 19   DT1        dper     1   undefined
#&gt; 20   DT1        estr     1   undefined
#&gt; 21   DT1        hobv     1   undefined
#&gt; 22   DT1        mbor     5   undefined
#&gt; 23   DT1        pvic     1   undefined
#&gt; 24   DT2        amin     2   undefined
#&gt; 25   DT2        apur     1   undefined
#&gt; 26   DT2        bbip     1   undefined
#&gt; 27   DT2        clam     2   undefined
#&gt; 28   DT2        dper     1   undefined
#&gt; 29   DT2        druf     1   undefined
#&gt; 30   DT2        estr     1   undefined
#&gt; 31   DT2        hobv     1   undefined
#&gt; 32   DT2        tuni     1   undefined
#&gt; 33   DT2        vidi     2   undefined
#&gt; 34   DT3        amin     3   undefined
#&gt; 35   DT3        bbip     1   undefined
#&gt; 36   DT3        hobv     6   undefined
#&gt; 37   DT3        pvic     1   undefined
#&gt; 38   DT3        vidi     2   undefined
#&gt; 39   LQ1        aacu     1   undefined
#&gt; 40   LQ1        amin     3   undefined
#&gt; 41   LQ1        dper     1   undefined
#&gt; 42   LQ1        ffau     1   undefined
#&gt; 43   LQ1        ppyg    28   undefined
#&gt; 44   LQ2        aacu     1   undefined
#&gt; 45   LQ2        amin     1   undefined
#&gt; 46   LQ2        dper     1   undefined
#&gt; 47   LQ2        ppyg    13   undefined
#&gt; 48   LQ2        pvic     1   undefined
#&gt; 49   LQ3        amin     2   undefined
#&gt; 50   LQ3        apur     1   undefined
#&gt; 51   LQ3        bbip     1   undefined
#&gt; 52   LQ3        ccer     1   undefined
#&gt; 53   LQ3        dper     7   undefined
#&gt; 54   LQ3        ppyg    69   undefined
#&gt; 55   LQ3        pvic     1   undefined
#&gt; 56   LT1 zero.pseudo     0 zero.pseudo
#&gt; 57   LT2        amin     1   undefined
#&gt; 58   LT2        pvic     1   undefined
#&gt; 59   LT3        amin     5   undefined
#&gt; 60   LT3        dper     1   undefined
#&gt; 61   LT3        pinc     1   undefined
#&gt; 62   LT3        pvic     1   undefined
#&gt; 63   LT3        tuni     2   undefined
#&gt; 64   RQ1        amin     3   undefined
#&gt; 65   RQ1        ccer     1   undefined
#&gt; 66   RQ1        clam     1   undefined
#&gt; 67   RQ1        cort     1   undefined
#&gt; 68   RQ1        dper     3   undefined
#&gt; 69   RQ1        ffau     2   undefined
#&gt; 70   RQ1        hobv     2   undefined
#&gt; 71   RQ1        ogla     1   undefined
#&gt; 72   RQ1        ppyg     5   undefined
#&gt; 73   RQ1        vidi     4   undefined
#&gt; 74   RQ2        amin     7   undefined
#&gt; 75   RQ2        bbip     4   undefined
#&gt; 76   RQ2        ctri     7   undefined
#&gt; 77   RQ2        dbre     1   undefined
#&gt; 78   RQ2        dper     6   undefined
#&gt; 79   RQ2        estr     3   undefined
#&gt; 80   RQ2        ffau     2   undefined
#&gt; 81   RQ2        hobv     9   undefined
#&gt; 82   RQ2        mobs     2   undefined
#&gt; 83   RQ2        odol    13   undefined
#&gt; 84   RQ2        ogla     3   undefined
#&gt; 85   RQ2        ppyg    28   undefined
#&gt; 86   RQ2        pvic     1   undefined
#&gt; 87   RQ2        tuni     2   undefined
#&gt; 88   RQ2        vcos     2   undefined
#&gt; 89   RQ2        vidi     7   undefined
#&gt; 90   RQ3        aacu     2   undefined
#&gt; 91   RQ3        amin    13   undefined
#&gt; 92   RQ3        bbip     1   undefined
#&gt; 93   RQ3        ctri    10   undefined
#&gt; 94   RQ3        dbre     3   undefined
#&gt; 95   RQ3        dper     6   undefined
#&gt; 96   RQ3        eful     2   undefined
#&gt; 97   RQ3        ffau     2   undefined
#&gt; 98   RQ3        hobv     2   undefined
#&gt; 99   RQ3        mobs     1   undefined
#&gt; 100  RQ3        ppyg     9   undefined
#&gt; 101  RQ3        pvic     1   undefined
#&gt; 102  RQ3        vidi    11   undefined
#&gt; 103  RT1        amin     4   undefined
#&gt; 104  RT1        bbip     3   undefined
#&gt; 105  RT1        ccer     2   undefined
#&gt; 106  RT1        cort     1   undefined
#&gt; 107  RT1        dper     1   undefined
#&gt; 108  RT1        ffau     7   undefined
#&gt; 109  RT1        hobv     8   undefined
#&gt; 110  RT1        iiso     6   undefined
#&gt; 111  RT1        pinc     3   undefined
#&gt; 112  RT1        pvic     4   undefined
#&gt; 113  RT1        tuni     5   undefined
#&gt; 114  RT2        amin     1   undefined
#&gt; 115  RT2        apur     2   undefined
#&gt; 116  RT2        bbip     3   undefined
#&gt; 117  RT2        bcan     1   undefined
#&gt; 118  RT2        cort     1   undefined
#&gt; 119  RT2        ctri     1   undefined
#&gt; 120  RT2        dper     2   undefined
#&gt; 121  RT2        estr     4   undefined
#&gt; 122  RT2        ffau    12   undefined
#&gt; 123  RT2        hobv     1   undefined
#&gt; 124  RT2        iiso     8   undefined
#&gt; 125  RT2        pinc     5   undefined
#&gt; 126  RT2        pvic     1   undefined
#&gt; 127  RT2        tuni     3   undefined
#&gt; 128  RT2        vidi     2   undefined
#&gt; 129  RT3        amin     5   undefined
#&gt; 130  RT3        apur     1   undefined
#&gt; 131  RT3        bbip     5   undefined
#&gt; 132  RT3        clam     1   undefined
#&gt; 133  RT3        ffau     6   undefined
#&gt; 134  RT3        hobv     4   undefined
#&gt; 135  RT3        iiso     1   undefined
#&gt; 136  RT3        pinc     3   undefined
#&gt; 137  RT3        pvic     3   undefined
#&gt; 138  RT3        tuni     1   undefined
#&gt; 139  WQ1        amin     3   undefined
#&gt; 140  WQ1        bbip     1   undefined
#&gt; 141  WQ1        bcan     1   undefined
#&gt; 142  WQ1        cort     3   undefined
#&gt; 143  WQ1        iiso     2   undefined
#&gt; 144  WQ1        pinc     2   undefined
#&gt; 145  WQ1        ppyg    31   undefined
#&gt; 146  WQ1        pvic     1   undefined
#&gt; 147  WQ1        vidi     4   undefined
#&gt; 148  WQ2        amin     4   undefined
#&gt; 149  WQ2        bbip     1   undefined
#&gt; 150  WQ2        ccer     1   undefined
#&gt; 151  WQ2        dper    20   undefined
#&gt; 152  WQ2        estr     2   undefined
#&gt; 153  WQ2        mobs     2   undefined
#&gt; 154  WQ2        pinc     1   undefined
#&gt; 155  WQ2        ppyg    56   undefined
#&gt; 156  WQ2        pvic     1   undefined
#&gt; 157  WQ2        tuni     2   undefined
#&gt; 158  WQ3        amin    10   undefined
#&gt; 159  WQ3        bbip     3   undefined
#&gt; 160  WQ3        estr     1   undefined
#&gt; 161  WQ3        ffau     2   undefined
#&gt; 162  WQ3        pinc     1   undefined
#&gt; 163  WQ3        ppyg     5   undefined
#&gt; 164  WQ3        vicr     1   undefined
#&gt; 165  WQ3        vidi     1   undefined
#&gt; 166  WT1        amin     1   undefined
#&gt; 167  WT1        cort     1   undefined
#&gt; 168  WT1        estr     1   undefined
#&gt; 169  WT1        ffau     1   undefined
#&gt; 170  WT1        tuni     1   undefined
#&gt; 171  WT2        amin     2   undefined
#&gt; 172  WT2        apur     1   undefined
#&gt; 173  WT2        bbip     1   undefined
#&gt; 174  WT2        dper     2   undefined
#&gt; 175  WT3        amin     4   undefined
#&gt; 176  WT3        ffau     1   undefined
#&gt; 177  WT3        vidi     1   undefined</div><div class='input'><span class='co'>## These two are identical</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"microhab"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa count        segm
#&gt; 1    DQ1        amin     4   dead.wood
#&gt; 2    DQ1        ctri     2   dead.wood
#&gt; 3    DQ1        dper     2   dead.wood
#&gt; 4    DQ1        estr     1   dead.wood
#&gt; 5    DQ1        vidi     9   dead.wood
#&gt; 6    DQ2        amin     4   dead.wood
#&gt; 7    DQ2        apur     1   dead.wood
#&gt; 8    DQ2        ctri    20   dead.wood
#&gt; 9    DQ2        dper     2   dead.wood
#&gt; 10   DQ2        druf     2   dead.wood
#&gt; 11   DQ2        ppyg     1   dead.wood
#&gt; 12   DQ2        vidi     9   dead.wood
#&gt; 13   DQ3        amin     3   dead.wood
#&gt; 14   DQ3        apur     1   dead.wood
#&gt; 15   DQ3        hobv     3   dead.wood
#&gt; 16   DQ3        vidi     2   dead.wood
#&gt; 17   DT1        amin     1   dead.wood
#&gt; 18   DT1        bcan     1   dead.wood
#&gt; 19   DT1        dper     1   dead.wood
#&gt; 20   DT1        estr     1   dead.wood
#&gt; 21   DT1        hobv     1   dead.wood
#&gt; 22   DT1        mbor     5   dead.wood
#&gt; 23   DT1        pvic     1   dead.wood
#&gt; 24   DT2        amin     2   dead.wood
#&gt; 25   DT2        apur     1   dead.wood
#&gt; 26   DT2        bbip     1   dead.wood
#&gt; 27   DT2        clam     2   dead.wood
#&gt; 28   DT2        dper     1   dead.wood
#&gt; 29   DT2        druf     1   dead.wood
#&gt; 30   DT2        estr     1   dead.wood
#&gt; 31   DT2        hobv     1   dead.wood
#&gt; 32   DT2        tuni     1   dead.wood
#&gt; 33   DT2        vidi     2   dead.wood
#&gt; 34   DT3        amin     3   dead.wood
#&gt; 35   DT3        bbip     1   dead.wood
#&gt; 36   DT3        hobv     6   dead.wood
#&gt; 37   DT3        pvic     1   dead.wood
#&gt; 38   DT3        vidi     2   dead.wood
#&gt; 39   LQ1        aacu     1      litter
#&gt; 40   LQ1        amin     3      litter
#&gt; 41   LQ1        dper     1      litter
#&gt; 42   LQ1        ffau     1      litter
#&gt; 43   LQ1        ppyg    28      litter
#&gt; 44   LQ2        aacu     1      litter
#&gt; 45   LQ2        amin     1      litter
#&gt; 46   LQ2        dper     1      litter
#&gt; 47   LQ2        ppyg    13      litter
#&gt; 48   LQ2        pvic     1      litter
#&gt; 49   LQ3        amin     2      litter
#&gt; 50   LQ3        apur     1      litter
#&gt; 51   LQ3        bbip     1      litter
#&gt; 52   LQ3        ccer     1      litter
#&gt; 53   LQ3        dper     7      litter
#&gt; 54   LQ3        ppyg    69      litter
#&gt; 55   LQ3        pvic     1      litter
#&gt; 56   LT1 zero.pseudo     0 zero.pseudo
#&gt; 57   LT2        amin     1      litter
#&gt; 58   LT2        pvic     1      litter
#&gt; 59   LT3        amin     5      litter
#&gt; 60   LT3        dper     1      litter
#&gt; 61   LT3        pinc     1      litter
#&gt; 62   LT3        pvic     1      litter
#&gt; 63   LT3        tuni     2      litter
#&gt; 64   RQ1        amin     3        rock
#&gt; 65   RQ1        ccer     1        rock
#&gt; 66   RQ1        clam     1        rock
#&gt; 67   RQ1        cort     1        rock
#&gt; 68   RQ1        dper     3        rock
#&gt; 69   RQ1        ffau     2        rock
#&gt; 70   RQ1        hobv     2        rock
#&gt; 71   RQ1        ogla     1        rock
#&gt; 72   RQ1        ppyg     5        rock
#&gt; 73   RQ1        vidi     4        rock
#&gt; 74   RQ2        amin     7        rock
#&gt; 75   RQ2        bbip     4        rock
#&gt; 76   RQ2        ctri     7        rock
#&gt; 77   RQ2        dbre     1        rock
#&gt; 78   RQ2        dper     6        rock
#&gt; 79   RQ2        estr     3        rock
#&gt; 80   RQ2        ffau     2        rock
#&gt; 81   RQ2        hobv     9        rock
#&gt; 82   RQ2        mobs     2        rock
#&gt; 83   RQ2        odol    13        rock
#&gt; 84   RQ2        ogla     3        rock
#&gt; 85   RQ2        ppyg    28        rock
#&gt; 86   RQ2        pvic     1        rock
#&gt; 87   RQ2        tuni     2        rock
#&gt; 88   RQ2        vcos     2        rock
#&gt; 89   RQ2        vidi     7        rock
#&gt; 90   RQ3        aacu     2        rock
#&gt; 91   RQ3        amin    13        rock
#&gt; 92   RQ3        bbip     1        rock
#&gt; 93   RQ3        ctri    10        rock
#&gt; 94   RQ3        dbre     3        rock
#&gt; 95   RQ3        dper     6        rock
#&gt; 96   RQ3        eful     2        rock
#&gt; 97   RQ3        ffau     2        rock
#&gt; 98   RQ3        hobv     2        rock
#&gt; 99   RQ3        mobs     1        rock
#&gt; 100  RQ3        ppyg     9        rock
#&gt; 101  RQ3        pvic     1        rock
#&gt; 102  RQ3        vidi    11        rock
#&gt; 103  RT1        amin     4        rock
#&gt; 104  RT1        bbip     3        rock
#&gt; 105  RT1        ccer     2        rock
#&gt; 106  RT1        cort     1        rock
#&gt; 107  RT1        dper     1        rock
#&gt; 108  RT1        ffau     7        rock
#&gt; 109  RT1        hobv     8        rock
#&gt; 110  RT1        iiso     6        rock
#&gt; 111  RT1        pinc     3        rock
#&gt; 112  RT1        pvic     4        rock
#&gt; 113  RT1        tuni     5        rock
#&gt; 114  RT2        amin     1        rock
#&gt; 115  RT2        apur     2        rock
#&gt; 116  RT2        bbip     3        rock
#&gt; 117  RT2        bcan     1        rock
#&gt; 118  RT2        cort     1        rock
#&gt; 119  RT2        ctri     1        rock
#&gt; 120  RT2        dper     2        rock
#&gt; 121  RT2        estr     4        rock
#&gt; 122  RT2        ffau    12        rock
#&gt; 123  RT2        hobv     1        rock
#&gt; 124  RT2        iiso     8        rock
#&gt; 125  RT2        pinc     5        rock
#&gt; 126  RT2        pvic     1        rock
#&gt; 127  RT2        tuni     3        rock
#&gt; 128  RT2        vidi     2        rock
#&gt; 129  RT3        amin     5        rock
#&gt; 130  RT3        apur     1        rock
#&gt; 131  RT3        bbip     5        rock
#&gt; 132  RT3        clam     1        rock
#&gt; 133  RT3        ffau     6        rock
#&gt; 134  RT3        hobv     4        rock
#&gt; 135  RT3        iiso     1        rock
#&gt; 136  RT3        pinc     3        rock
#&gt; 137  RT3        pvic     3        rock
#&gt; 138  RT3        tuni     1        rock
#&gt; 139  WQ1        amin     3   live.wood
#&gt; 140  WQ1        bbip     1   live.wood
#&gt; 141  WQ1        bcan     1   live.wood
#&gt; 142  WQ1        cort     3   live.wood
#&gt; 143  WQ1        iiso     2   live.wood
#&gt; 144  WQ1        pinc     2   live.wood
#&gt; 145  WQ1        ppyg    31   live.wood
#&gt; 146  WQ1        pvic     1   live.wood
#&gt; 147  WQ1        vidi     4   live.wood
#&gt; 148  WQ2        amin     4   live.wood
#&gt; 149  WQ2        bbip     1   live.wood
#&gt; 150  WQ2        ccer     1   live.wood
#&gt; 151  WQ2        dper    20   live.wood
#&gt; 152  WQ2        estr     2   live.wood
#&gt; 153  WQ2        mobs     2   live.wood
#&gt; 154  WQ2        pinc     1   live.wood
#&gt; 155  WQ2        ppyg    56   live.wood
#&gt; 156  WQ2        pvic     1   live.wood
#&gt; 157  WQ2        tuni     2   live.wood
#&gt; 158  WQ3        amin    10   live.wood
#&gt; 159  WQ3        bbip     3   live.wood
#&gt; 160  WQ3        estr     1   live.wood
#&gt; 161  WQ3        ffau     2   live.wood
#&gt; 162  WQ3        pinc     1   live.wood
#&gt; 163  WQ3        ppyg     5   live.wood
#&gt; 164  WQ3        vicr     1   live.wood
#&gt; 165  WQ3        vidi     1   live.wood
#&gt; 166  WT1        amin     1   live.wood
#&gt; 167  WT1        cort     1   live.wood
#&gt; 168  WT1        estr     1   live.wood
#&gt; 169  WT1        ffau     1   live.wood
#&gt; 170  WT1        tuni     1   live.wood
#&gt; 171  WT2        amin     2   live.wood
#&gt; 172  WT2        apur     1   live.wood
#&gt; 173  WT2        bbip     1   live.wood
#&gt; 174  WT2        dper     2   live.wood
#&gt; 175  WT3        amin     4   live.wood
#&gt; 176  WT3        ffau     1   live.wood
#&gt; 177  WT3        vidi     1   live.wood</div><div class='input'><span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samp</span><span class='op'>$</span><span class='va'>microhab</span><span class='op'>)</span> <span class='co'>## this is a factor</span>
</div><div class='output co'>#&gt;     samp        taxa count        segm
#&gt; 1    DQ1        amin     4   dead.wood
#&gt; 2    DQ1        ctri     2   dead.wood
#&gt; 3    DQ1        dper     2   dead.wood
#&gt; 4    DQ1        estr     1   dead.wood
#&gt; 5    DQ1        vidi     9   dead.wood
#&gt; 6    DQ2        amin     4   dead.wood
#&gt; 7    DQ2        apur     1   dead.wood
#&gt; 8    DQ2        ctri    20   dead.wood
#&gt; 9    DQ2        dper     2   dead.wood
#&gt; 10   DQ2        druf     2   dead.wood
#&gt; 11   DQ2        ppyg     1   dead.wood
#&gt; 12   DQ2        vidi     9   dead.wood
#&gt; 13   DQ3        amin     3   dead.wood
#&gt; 14   DQ3        apur     1   dead.wood
#&gt; 15   DQ3        hobv     3   dead.wood
#&gt; 16   DQ3        vidi     2   dead.wood
#&gt; 17   DT1        amin     1   dead.wood
#&gt; 18   DT1        bcan     1   dead.wood
#&gt; 19   DT1        dper     1   dead.wood
#&gt; 20   DT1        estr     1   dead.wood
#&gt; 21   DT1        hobv     1   dead.wood
#&gt; 22   DT1        mbor     5   dead.wood
#&gt; 23   DT1        pvic     1   dead.wood
#&gt; 24   DT2        amin     2   dead.wood
#&gt; 25   DT2        apur     1   dead.wood
#&gt; 26   DT2        bbip     1   dead.wood
#&gt; 27   DT2        clam     2   dead.wood
#&gt; 28   DT2        dper     1   dead.wood
#&gt; 29   DT2        druf     1   dead.wood
#&gt; 30   DT2        estr     1   dead.wood
#&gt; 31   DT2        hobv     1   dead.wood
#&gt; 32   DT2        tuni     1   dead.wood
#&gt; 33   DT2        vidi     2   dead.wood
#&gt; 34   DT3        amin     3   dead.wood
#&gt; 35   DT3        bbip     1   dead.wood
#&gt; 36   DT3        hobv     6   dead.wood
#&gt; 37   DT3        pvic     1   dead.wood
#&gt; 38   DT3        vidi     2   dead.wood
#&gt; 39   LQ1        aacu     1      litter
#&gt; 40   LQ1        amin     3      litter
#&gt; 41   LQ1        dper     1      litter
#&gt; 42   LQ1        ffau     1      litter
#&gt; 43   LQ1        ppyg    28      litter
#&gt; 44   LQ2        aacu     1      litter
#&gt; 45   LQ2        amin     1      litter
#&gt; 46   LQ2        dper     1      litter
#&gt; 47   LQ2        ppyg    13      litter
#&gt; 48   LQ2        pvic     1      litter
#&gt; 49   LQ3        amin     2      litter
#&gt; 50   LQ3        apur     1      litter
#&gt; 51   LQ3        bbip     1      litter
#&gt; 52   LQ3        ccer     1      litter
#&gt; 53   LQ3        dper     7      litter
#&gt; 54   LQ3        ppyg    69      litter
#&gt; 55   LQ3        pvic     1      litter
#&gt; 56   LT1 zero.pseudo     0 zero.pseudo
#&gt; 57   LT2        amin     1      litter
#&gt; 58   LT2        pvic     1      litter
#&gt; 59   LT3        amin     5      litter
#&gt; 60   LT3        dper     1      litter
#&gt; 61   LT3        pinc     1      litter
#&gt; 62   LT3        pvic     1      litter
#&gt; 63   LT3        tuni     2      litter
#&gt; 64   RQ1        amin     3        rock
#&gt; 65   RQ1        ccer     1        rock
#&gt; 66   RQ1        clam     1        rock
#&gt; 67   RQ1        cort     1        rock
#&gt; 68   RQ1        dper     3        rock
#&gt; 69   RQ1        ffau     2        rock
#&gt; 70   RQ1        hobv     2        rock
#&gt; 71   RQ1        ogla     1        rock
#&gt; 72   RQ1        ppyg     5        rock
#&gt; 73   RQ1        vidi     4        rock
#&gt; 74   RQ2        amin     7        rock
#&gt; 75   RQ2        bbip     4        rock
#&gt; 76   RQ2        ctri     7        rock
#&gt; 77   RQ2        dbre     1        rock
#&gt; 78   RQ2        dper     6        rock
#&gt; 79   RQ2        estr     3        rock
#&gt; 80   RQ2        ffau     2        rock
#&gt; 81   RQ2        hobv     9        rock
#&gt; 82   RQ2        mobs     2        rock
#&gt; 83   RQ2        odol    13        rock
#&gt; 84   RQ2        ogla     3        rock
#&gt; 85   RQ2        ppyg    28        rock
#&gt; 86   RQ2        pvic     1        rock
#&gt; 87   RQ2        tuni     2        rock
#&gt; 88   RQ2        vcos     2        rock
#&gt; 89   RQ2        vidi     7        rock
#&gt; 90   RQ3        aacu     2        rock
#&gt; 91   RQ3        amin    13        rock
#&gt; 92   RQ3        bbip     1        rock
#&gt; 93   RQ3        ctri    10        rock
#&gt; 94   RQ3        dbre     3        rock
#&gt; 95   RQ3        dper     6        rock
#&gt; 96   RQ3        eful     2        rock
#&gt; 97   RQ3        ffau     2        rock
#&gt; 98   RQ3        hobv     2        rock
#&gt; 99   RQ3        mobs     1        rock
#&gt; 100  RQ3        ppyg     9        rock
#&gt; 101  RQ3        pvic     1        rock
#&gt; 102  RQ3        vidi    11        rock
#&gt; 103  RT1        amin     4        rock
#&gt; 104  RT1        bbip     3        rock
#&gt; 105  RT1        ccer     2        rock
#&gt; 106  RT1        cort     1        rock
#&gt; 107  RT1        dper     1        rock
#&gt; 108  RT1        ffau     7        rock
#&gt; 109  RT1        hobv     8        rock
#&gt; 110  RT1        iiso     6        rock
#&gt; 111  RT1        pinc     3        rock
#&gt; 112  RT1        pvic     4        rock
#&gt; 113  RT1        tuni     5        rock
#&gt; 114  RT2        amin     1        rock
#&gt; 115  RT2        apur     2        rock
#&gt; 116  RT2        bbip     3        rock
#&gt; 117  RT2        bcan     1        rock
#&gt; 118  RT2        cort     1        rock
#&gt; 119  RT2        ctri     1        rock
#&gt; 120  RT2        dper     2        rock
#&gt; 121  RT2        estr     4        rock
#&gt; 122  RT2        ffau    12        rock
#&gt; 123  RT2        hobv     1        rock
#&gt; 124  RT2        iiso     8        rock
#&gt; 125  RT2        pinc     5        rock
#&gt; 126  RT2        pvic     1        rock
#&gt; 127  RT2        tuni     3        rock
#&gt; 128  RT2        vidi     2        rock
#&gt; 129  RT3        amin     5        rock
#&gt; 130  RT3        apur     1        rock
#&gt; 131  RT3        bbip     5        rock
#&gt; 132  RT3        clam     1        rock
#&gt; 133  RT3        ffau     6        rock
#&gt; 134  RT3        hobv     4        rock
#&gt; 135  RT3        iiso     1        rock
#&gt; 136  RT3        pinc     3        rock
#&gt; 137  RT3        pvic     3        rock
#&gt; 138  RT3        tuni     1        rock
#&gt; 139  WQ1        amin     3   live.wood
#&gt; 140  WQ1        bbip     1   live.wood
#&gt; 141  WQ1        bcan     1   live.wood
#&gt; 142  WQ1        cort     3   live.wood
#&gt; 143  WQ1        iiso     2   live.wood
#&gt; 144  WQ1        pinc     2   live.wood
#&gt; 145  WQ1        ppyg    31   live.wood
#&gt; 146  WQ1        pvic     1   live.wood
#&gt; 147  WQ1        vidi     4   live.wood
#&gt; 148  WQ2        amin     4   live.wood
#&gt; 149  WQ2        bbip     1   live.wood
#&gt; 150  WQ2        ccer     1   live.wood
#&gt; 151  WQ2        dper    20   live.wood
#&gt; 152  WQ2        estr     2   live.wood
#&gt; 153  WQ2        mobs     2   live.wood
#&gt; 154  WQ2        pinc     1   live.wood
#&gt; 155  WQ2        ppyg    56   live.wood
#&gt; 156  WQ2        pvic     1   live.wood
#&gt; 157  WQ2        tuni     2   live.wood
#&gt; 158  WQ3        amin    10   live.wood
#&gt; 159  WQ3        bbip     3   live.wood
#&gt; 160  WQ3        estr     1   live.wood
#&gt; 161  WQ3        ffau     2   live.wood
#&gt; 162  WQ3        pinc     1   live.wood
#&gt; 163  WQ3        ppyg     5   live.wood
#&gt; 164  WQ3        vicr     1   live.wood
#&gt; 165  WQ3        vidi     1   live.wood
#&gt; 166  WT1        amin     1   live.wood
#&gt; 167  WT1        cort     1   live.wood
#&gt; 168  WT1        estr     1   live.wood
#&gt; 169  WT1        ffau     1   live.wood
#&gt; 170  WT1        tuni     1   live.wood
#&gt; 171  WT2        amin     2   live.wood
#&gt; 172  WT2        apur     1   live.wood
#&gt; 173  WT2        bbip     1   live.wood
#&gt; 174  WT2        dper     2   live.wood
#&gt; 175  WT3        amin     4   live.wood
#&gt; 176  WT3        ffau     1   live.wood
#&gt; 177  WT3        vidi     1   live.wood</div><div class='input'><span class='co'>## Using a simple vector as factor</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa count        segm
#&gt; 1    DQ1        amin     4           0
#&gt; 2    DQ1        ctri     2           0
#&gt; 3    DQ1        dper     2           0
#&gt; 4    DQ1        estr     1           0
#&gt; 5    DQ1        vidi     9           0
#&gt; 6    DQ2        amin     4           0
#&gt; 7    DQ2        apur     1           0
#&gt; 8    DQ2        ctri    20           0
#&gt; 9    DQ2        dper     2           0
#&gt; 10   DQ2        druf     2           0
#&gt; 11   DQ2        ppyg     1           0
#&gt; 12   DQ2        vidi     9           0
#&gt; 13   DQ3        amin     3           0
#&gt; 14   DQ3        apur     1           0
#&gt; 15   DQ3        hobv     3           0
#&gt; 16   DQ3        vidi     2           0
#&gt; 17   DT1        amin     1           1
#&gt; 18   DT1        bcan     1           1
#&gt; 19   DT1        dper     1           1
#&gt; 20   DT1        estr     1           1
#&gt; 21   DT1        hobv     1           1
#&gt; 22   DT1        mbor     5           1
#&gt; 23   DT1        pvic     1           1
#&gt; 24   DT2        amin     2           1
#&gt; 25   DT2        apur     1           1
#&gt; 26   DT2        bbip     1           1
#&gt; 27   DT2        clam     2           1
#&gt; 28   DT2        dper     1           1
#&gt; 29   DT2        druf     1           1
#&gt; 30   DT2        estr     1           1
#&gt; 31   DT2        hobv     1           1
#&gt; 32   DT2        tuni     1           1
#&gt; 33   DT2        vidi     2           1
#&gt; 34   DT3        amin     3           1
#&gt; 35   DT3        bbip     1           1
#&gt; 36   DT3        hobv     6           1
#&gt; 37   DT3        pvic     1           1
#&gt; 38   DT3        vidi     2           1
#&gt; 39   LQ1        aacu     1           1
#&gt; 40   LQ1        amin     3           1
#&gt; 41   LQ1        dper     1           1
#&gt; 42   LQ1        ffau     1           1
#&gt; 43   LQ1        ppyg    28           1
#&gt; 44   LQ2        aacu     1           1
#&gt; 45   LQ2        amin     1           1
#&gt; 46   LQ2        dper     1           1
#&gt; 47   LQ2        ppyg    13           1
#&gt; 48   LQ2        pvic     1           1
#&gt; 49   LQ3        amin     2           1
#&gt; 50   LQ3        apur     1           1
#&gt; 51   LQ3        bbip     1           1
#&gt; 52   LQ3        ccer     1           1
#&gt; 53   LQ3        dper     7           1
#&gt; 54   LQ3        ppyg    69           1
#&gt; 55   LQ3        pvic     1           1
#&gt; 56   LT1 zero.pseudo     0 zero.pseudo
#&gt; 57   LT2        amin     1           0
#&gt; 58   LT2        pvic     1           0
#&gt; 59   LT3        amin     5           1
#&gt; 60   LT3        dper     1           1
#&gt; 61   LT3        pinc     1           1
#&gt; 62   LT3        pvic     1           1
#&gt; 63   LT3        tuni     2           1
#&gt; 64   RQ1        amin     3           0
#&gt; 65   RQ1        ccer     1           0
#&gt; 66   RQ1        clam     1           0
#&gt; 67   RQ1        cort     1           0
#&gt; 68   RQ1        dper     3           0
#&gt; 69   RQ1        ffau     2           0
#&gt; 70   RQ1        hobv     2           0
#&gt; 71   RQ1        ogla     1           0
#&gt; 72   RQ1        ppyg     5           0
#&gt; 73   RQ1        vidi     4           0
#&gt; 74   RQ2        amin     7           1
#&gt; 75   RQ2        bbip     4           1
#&gt; 76   RQ2        ctri     7           1
#&gt; 77   RQ2        dbre     1           1
#&gt; 78   RQ2        dper     6           1
#&gt; 79   RQ2        estr     3           1
#&gt; 80   RQ2        ffau     2           1
#&gt; 81   RQ2        hobv     9           1
#&gt; 82   RQ2        mobs     2           1
#&gt; 83   RQ2        odol    13           1
#&gt; 84   RQ2        ogla     3           1
#&gt; 85   RQ2        ppyg    28           1
#&gt; 86   RQ2        pvic     1           1
#&gt; 87   RQ2        tuni     2           1
#&gt; 88   RQ2        vcos     2           1
#&gt; 89   RQ2        vidi     7           1
#&gt; 90   RQ3        aacu     2           1
#&gt; 91   RQ3        amin    13           1
#&gt; 92   RQ3        bbip     1           1
#&gt; 93   RQ3        ctri    10           1
#&gt; 94   RQ3        dbre     3           1
#&gt; 95   RQ3        dper     6           1
#&gt; 96   RQ3        eful     2           1
#&gt; 97   RQ3        ffau     2           1
#&gt; 98   RQ3        hobv     2           1
#&gt; 99   RQ3        mobs     1           1
#&gt; 100  RQ3        ppyg     9           1
#&gt; 101  RQ3        pvic     1           1
#&gt; 102  RQ3        vidi    11           1
#&gt; 103  RT1        amin     4           0
#&gt; 104  RT1        bbip     3           0
#&gt; 105  RT1        ccer     2           0
#&gt; 106  RT1        cort     1           0
#&gt; 107  RT1        dper     1           0
#&gt; 108  RT1        ffau     7           0
#&gt; 109  RT1        hobv     8           0
#&gt; 110  RT1        iiso     6           0
#&gt; 111  RT1        pinc     3           0
#&gt; 112  RT1        pvic     4           0
#&gt; 113  RT1        tuni     5           0
#&gt; 114  RT2        amin     1           1
#&gt; 115  RT2        apur     2           1
#&gt; 116  RT2        bbip     3           1
#&gt; 117  RT2        bcan     1           1
#&gt; 118  RT2        cort     1           1
#&gt; 119  RT2        ctri     1           1
#&gt; 120  RT2        dper     2           1
#&gt; 121  RT2        estr     4           1
#&gt; 122  RT2        ffau    12           1
#&gt; 123  RT2        hobv     1           1
#&gt; 124  RT2        iiso     8           1
#&gt; 125  RT2        pinc     5           1
#&gt; 126  RT2        pvic     1           1
#&gt; 127  RT2        tuni     3           1
#&gt; 128  RT2        vidi     2           1
#&gt; 129  RT3        amin     5           0
#&gt; 130  RT3        apur     1           0
#&gt; 131  RT3        bbip     5           0
#&gt; 132  RT3        clam     1           0
#&gt; 133  RT3        ffau     6           0
#&gt; 134  RT3        hobv     4           0
#&gt; 135  RT3        iiso     1           0
#&gt; 136  RT3        pinc     3           0
#&gt; 137  RT3        pvic     3           0
#&gt; 138  RT3        tuni     1           0
#&gt; 139  WQ1        amin     3           1
#&gt; 140  WQ1        bbip     1           1
#&gt; 141  WQ1        bcan     1           1
#&gt; 142  WQ1        cort     3           1
#&gt; 143  WQ1        iiso     2           1
#&gt; 144  WQ1        pinc     2           1
#&gt; 145  WQ1        ppyg    31           1
#&gt; 146  WQ1        pvic     1           1
#&gt; 147  WQ1        vidi     4           1
#&gt; 148  WQ2        amin     4           0
#&gt; 149  WQ2        bbip     1           0
#&gt; 150  WQ2        ccer     1           0
#&gt; 151  WQ2        dper    20           0
#&gt; 152  WQ2        estr     2           0
#&gt; 153  WQ2        mobs     2           0
#&gt; 154  WQ2        pinc     1           0
#&gt; 155  WQ2        ppyg    56           0
#&gt; 156  WQ2        pvic     1           0
#&gt; 157  WQ2        tuni     2           0
#&gt; 158  WQ3        amin    10           1
#&gt; 159  WQ3        bbip     3           1
#&gt; 160  WQ3        estr     1           1
#&gt; 161  WQ3        ffau     2           1
#&gt; 162  WQ3        pinc     1           1
#&gt; 163  WQ3        ppyg     5           1
#&gt; 164  WQ3        vicr     1           1
#&gt; 165  WQ3        vidi     1           1
#&gt; 166  WT1        amin     1           1
#&gt; 167  WT1        cort     1           1
#&gt; 168  WT1        estr     1           1
#&gt; 169  WT1        ffau     1           1
#&gt; 170  WT1        tuni     1           1
#&gt; 171  WT2        amin     2           1
#&gt; 172  WT2        apur     1           1
#&gt; 173  WT2        bbip     1           1
#&gt; 174  WT2        dper     2           1
#&gt; 175  WT3        amin     4           0
#&gt; 176  WT3        ffau     1           0
#&gt; 177  WT3        vidi     1           0</div><div class='input'><span class='co'>## Interaction</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"method"</span>, <span class='st'>"microhab"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa count              segm
#&gt; 1    DQ1        amin     4 quadrat.dead.wood
#&gt; 2    DQ1        ctri     2 quadrat.dead.wood
#&gt; 3    DQ1        dper     2 quadrat.dead.wood
#&gt; 4    DQ1        estr     1 quadrat.dead.wood
#&gt; 5    DQ1        vidi     9 quadrat.dead.wood
#&gt; 6    DQ2        amin     4 quadrat.dead.wood
#&gt; 7    DQ2        apur     1 quadrat.dead.wood
#&gt; 8    DQ2        ctri    20 quadrat.dead.wood
#&gt; 9    DQ2        dper     2 quadrat.dead.wood
#&gt; 10   DQ2        druf     2 quadrat.dead.wood
#&gt; 11   DQ2        ppyg     1 quadrat.dead.wood
#&gt; 12   DQ2        vidi     9 quadrat.dead.wood
#&gt; 13   DQ3        amin     3 quadrat.dead.wood
#&gt; 14   DQ3        apur     1 quadrat.dead.wood
#&gt; 15   DQ3        hobv     3 quadrat.dead.wood
#&gt; 16   DQ3        vidi     2 quadrat.dead.wood
#&gt; 17   DT1        amin     1    time.dead.wood
#&gt; 18   DT1        bcan     1    time.dead.wood
#&gt; 19   DT1        dper     1    time.dead.wood
#&gt; 20   DT1        estr     1    time.dead.wood
#&gt; 21   DT1        hobv     1    time.dead.wood
#&gt; 22   DT1        mbor     5    time.dead.wood
#&gt; 23   DT1        pvic     1    time.dead.wood
#&gt; 24   DT2        amin     2    time.dead.wood
#&gt; 25   DT2        apur     1    time.dead.wood
#&gt; 26   DT2        bbip     1    time.dead.wood
#&gt; 27   DT2        clam     2    time.dead.wood
#&gt; 28   DT2        dper     1    time.dead.wood
#&gt; 29   DT2        druf     1    time.dead.wood
#&gt; 30   DT2        estr     1    time.dead.wood
#&gt; 31   DT2        hobv     1    time.dead.wood
#&gt; 32   DT2        tuni     1    time.dead.wood
#&gt; 33   DT2        vidi     2    time.dead.wood
#&gt; 34   DT3        amin     3    time.dead.wood
#&gt; 35   DT3        bbip     1    time.dead.wood
#&gt; 36   DT3        hobv     6    time.dead.wood
#&gt; 37   DT3        pvic     1    time.dead.wood
#&gt; 38   DT3        vidi     2    time.dead.wood
#&gt; 39   LQ1        aacu     1    quadrat.litter
#&gt; 40   LQ1        amin     3    quadrat.litter
#&gt; 41   LQ1        dper     1    quadrat.litter
#&gt; 42   LQ1        ffau     1    quadrat.litter
#&gt; 43   LQ1        ppyg    28    quadrat.litter
#&gt; 44   LQ2        aacu     1    quadrat.litter
#&gt; 45   LQ2        amin     1    quadrat.litter
#&gt; 46   LQ2        dper     1    quadrat.litter
#&gt; 47   LQ2        ppyg    13    quadrat.litter
#&gt; 48   LQ2        pvic     1    quadrat.litter
#&gt; 49   LQ3        amin     2    quadrat.litter
#&gt; 50   LQ3        apur     1    quadrat.litter
#&gt; 51   LQ3        bbip     1    quadrat.litter
#&gt; 52   LQ3        ccer     1    quadrat.litter
#&gt; 53   LQ3        dper     7    quadrat.litter
#&gt; 54   LQ3        ppyg    69    quadrat.litter
#&gt; 55   LQ3        pvic     1    quadrat.litter
#&gt; 56   LT1 zero.pseudo     0       zero.pseudo
#&gt; 57   LT2        amin     1       time.litter
#&gt; 58   LT2        pvic     1       time.litter
#&gt; 59   LT3        amin     5       time.litter
#&gt; 60   LT3        dper     1       time.litter
#&gt; 61   LT3        pinc     1       time.litter
#&gt; 62   LT3        pvic     1       time.litter
#&gt; 63   LT3        tuni     2       time.litter
#&gt; 64   RQ1        amin     3      quadrat.rock
#&gt; 65   RQ1        ccer     1      quadrat.rock
#&gt; 66   RQ1        clam     1      quadrat.rock
#&gt; 67   RQ1        cort     1      quadrat.rock
#&gt; 68   RQ1        dper     3      quadrat.rock
#&gt; 69   RQ1        ffau     2      quadrat.rock
#&gt; 70   RQ1        hobv     2      quadrat.rock
#&gt; 71   RQ1        ogla     1      quadrat.rock
#&gt; 72   RQ1        ppyg     5      quadrat.rock
#&gt; 73   RQ1        vidi     4      quadrat.rock
#&gt; 74   RQ2        amin     7      quadrat.rock
#&gt; 75   RQ2        bbip     4      quadrat.rock
#&gt; 76   RQ2        ctri     7      quadrat.rock
#&gt; 77   RQ2        dbre     1      quadrat.rock
#&gt; 78   RQ2        dper     6      quadrat.rock
#&gt; 79   RQ2        estr     3      quadrat.rock
#&gt; 80   RQ2        ffau     2      quadrat.rock
#&gt; 81   RQ2        hobv     9      quadrat.rock
#&gt; 82   RQ2        mobs     2      quadrat.rock
#&gt; 83   RQ2        odol    13      quadrat.rock
#&gt; 84   RQ2        ogla     3      quadrat.rock
#&gt; 85   RQ2        ppyg    28      quadrat.rock
#&gt; 86   RQ2        pvic     1      quadrat.rock
#&gt; 87   RQ2        tuni     2      quadrat.rock
#&gt; 88   RQ2        vcos     2      quadrat.rock
#&gt; 89   RQ2        vidi     7      quadrat.rock
#&gt; 90   RQ3        aacu     2      quadrat.rock
#&gt; 91   RQ3        amin    13      quadrat.rock
#&gt; 92   RQ3        bbip     1      quadrat.rock
#&gt; 93   RQ3        ctri    10      quadrat.rock
#&gt; 94   RQ3        dbre     3      quadrat.rock
#&gt; 95   RQ3        dper     6      quadrat.rock
#&gt; 96   RQ3        eful     2      quadrat.rock
#&gt; 97   RQ3        ffau     2      quadrat.rock
#&gt; 98   RQ3        hobv     2      quadrat.rock
#&gt; 99   RQ3        mobs     1      quadrat.rock
#&gt; 100  RQ3        ppyg     9      quadrat.rock
#&gt; 101  RQ3        pvic     1      quadrat.rock
#&gt; 102  RQ3        vidi    11      quadrat.rock
#&gt; 103  RT1        amin     4         time.rock
#&gt; 104  RT1        bbip     3         time.rock
#&gt; 105  RT1        ccer     2         time.rock
#&gt; 106  RT1        cort     1         time.rock
#&gt; 107  RT1        dper     1         time.rock
#&gt; 108  RT1        ffau     7         time.rock
#&gt; 109  RT1        hobv     8         time.rock
#&gt; 110  RT1        iiso     6         time.rock
#&gt; 111  RT1        pinc     3         time.rock
#&gt; 112  RT1        pvic     4         time.rock
#&gt; 113  RT1        tuni     5         time.rock
#&gt; 114  RT2        amin     1         time.rock
#&gt; 115  RT2        apur     2         time.rock
#&gt; 116  RT2        bbip     3         time.rock
#&gt; 117  RT2        bcan     1         time.rock
#&gt; 118  RT2        cort     1         time.rock
#&gt; 119  RT2        ctri     1         time.rock
#&gt; 120  RT2        dper     2         time.rock
#&gt; 121  RT2        estr     4         time.rock
#&gt; 122  RT2        ffau    12         time.rock
#&gt; 123  RT2        hobv     1         time.rock
#&gt; 124  RT2        iiso     8         time.rock
#&gt; 125  RT2        pinc     5         time.rock
#&gt; 126  RT2        pvic     1         time.rock
#&gt; 127  RT2        tuni     3         time.rock
#&gt; 128  RT2        vidi     2         time.rock
#&gt; 129  RT3        amin     5         time.rock
#&gt; 130  RT3        apur     1         time.rock
#&gt; 131  RT3        bbip     5         time.rock
#&gt; 132  RT3        clam     1         time.rock
#&gt; 133  RT3        ffau     6         time.rock
#&gt; 134  RT3        hobv     4         time.rock
#&gt; 135  RT3        iiso     1         time.rock
#&gt; 136  RT3        pinc     3         time.rock
#&gt; 137  RT3        pvic     3         time.rock
#&gt; 138  RT3        tuni     1         time.rock
#&gt; 139  WQ1        amin     3 quadrat.live.wood
#&gt; 140  WQ1        bbip     1 quadrat.live.wood
#&gt; 141  WQ1        bcan     1 quadrat.live.wood
#&gt; 142  WQ1        cort     3 quadrat.live.wood
#&gt; 143  WQ1        iiso     2 quadrat.live.wood
#&gt; 144  WQ1        pinc     2 quadrat.live.wood
#&gt; 145  WQ1        ppyg    31 quadrat.live.wood
#&gt; 146  WQ1        pvic     1 quadrat.live.wood
#&gt; 147  WQ1        vidi     4 quadrat.live.wood
#&gt; 148  WQ2        amin     4 quadrat.live.wood
#&gt; 149  WQ2        bbip     1 quadrat.live.wood
#&gt; 150  WQ2        ccer     1 quadrat.live.wood
#&gt; 151  WQ2        dper    20 quadrat.live.wood
#&gt; 152  WQ2        estr     2 quadrat.live.wood
#&gt; 153  WQ2        mobs     2 quadrat.live.wood
#&gt; 154  WQ2        pinc     1 quadrat.live.wood
#&gt; 155  WQ2        ppyg    56 quadrat.live.wood
#&gt; 156  WQ2        pvic     1 quadrat.live.wood
#&gt; 157  WQ2        tuni     2 quadrat.live.wood
#&gt; 158  WQ3        amin    10 quadrat.live.wood
#&gt; 159  WQ3        bbip     3 quadrat.live.wood
#&gt; 160  WQ3        estr     1 quadrat.live.wood
#&gt; 161  WQ3        ffau     2 quadrat.live.wood
#&gt; 162  WQ3        pinc     1 quadrat.live.wood
#&gt; 163  WQ3        ppyg     5 quadrat.live.wood
#&gt; 164  WQ3        vicr     1 quadrat.live.wood
#&gt; 165  WQ3        vidi     1 quadrat.live.wood
#&gt; 166  WT1        amin     1    time.live.wood
#&gt; 167  WT1        cort     1    time.live.wood
#&gt; 168  WT1        estr     1    time.live.wood
#&gt; 169  WT1        ffau     1    time.live.wood
#&gt; 170  WT1        tuni     1    time.live.wood
#&gt; 171  WT2        amin     2    time.live.wood
#&gt; 172  WT2        apur     1    time.live.wood
#&gt; 173  WT2        bbip     1    time.live.wood
#&gt; 174  WT2        dper     2    time.live.wood
#&gt; 175  WT3        amin     4    time.live.wood
#&gt; 176  WT3        ffau     1    time.live.wood
#&gt; 177  WT3        vidi     1    time.live.wood</div><div class='input'><span class='co'>## From taxa table</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"familia"</span>, by.samp <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa count         segm
#&gt; 1    DQ1        amin     4    Helicidae
#&gt; 2    DQ1        ctri     2    Helicidae
#&gt; 3    DQ1        dper     2    Helicidae
#&gt; 4    DQ1        estr     1 Clausiliidae
#&gt; 5    DQ1        vidi     9 Clausiliidae
#&gt; 6    DQ2        amin     4  Valloniidae
#&gt; 7    DQ2        apur     1    Helicidae
#&gt; 8    DQ2        ctri    20  Valloniidae
#&gt; 9    DQ2        dper     2 Clausiliidae
#&gt; 10   DQ2        druf     2    Helicidae
#&gt; 11   DQ2        ppyg     1  Valloniidae
#&gt; 12   DQ2        vidi     9 Clausiliidae
#&gt; 13   DQ3        amin     3    Zonitidae
#&gt; 14   DQ3        apur     1 Endodontidae
#&gt; 15   DQ3        hobv     3    Zonitidae
#&gt; 16   DQ3        vidi     2 Clausiliidae
#&gt; 17   DT1        amin     1    Zonitidae
#&gt; 18   DT1        bcan     1    Helicidae
#&gt; 19   DT1        dper     1    Orculidae
#&gt; 20   DT1        estr     1 Clausiliidae
#&gt; 21   DT1        hobv     1    Zonitidae
#&gt; 22   DT1        mbor     5    Orculidae
#&gt; 23   DT1        pvic     1    Helicidae
#&gt; 24   DT2        amin     2  Valloniidae
#&gt; 25   DT2        apur     1    Helicidae
#&gt; 26   DT2        bbip     1    Zonitidae
#&gt; 27   DT2        clam     2   Ellobiidae
#&gt; 28   DT2        dper     1    Zonitidae
#&gt; 29   DT2        druf     1    Helicidae
#&gt; 30   DT2        estr     1   Ellobiidae
#&gt; 31   DT2        hobv     1  Valloniidae
#&gt; 32   DT2        tuni     1    Zonitidae
#&gt; 33   DT2        vidi     2   Ellobiidae
#&gt; 34   DT3        amin     3    Zonitidae
#&gt; 35   DT3        bbip     1    Helicidae
#&gt; 36   DT3        hobv     6    Zonitidae
#&gt; 37   DT3        pvic     1  Valloniidae
#&gt; 38   DT3        vidi     2    Zonitidae
#&gt; 39   LQ1        aacu     1 Clausiliidae
#&gt; 40   LQ1        amin     3    Zonitidae
#&gt; 41   LQ1        dper     1 Endodontidae
#&gt; 42   LQ1        ffau     1 Clausiliidae
#&gt; 43   LQ1        ppyg    28    Zonitidae
#&gt; 44   LQ2        aacu     1 Clausiliidae
#&gt; 45   LQ2        amin     1 Clausiliidae
#&gt; 46   LQ2        dper     1    Helicidae
#&gt; 47   LQ2        ppyg    13 Clausiliidae
#&gt; 48   LQ2        pvic     1    Zonitidae
#&gt; 49   LQ3        amin     2 Clausiliidae
#&gt; 50   LQ3        apur     1  Valloniidae
#&gt; 51   LQ3        bbip     1    Helicidae
#&gt; 52   LQ3        ccer     1    Helicidae
#&gt; 53   LQ3        dper     7    Helicidae
#&gt; 54   LQ3        ppyg    69 Clausiliidae
#&gt; 55   LQ3        pvic     1  Valloniidae
#&gt; 56   LT1 zero.pseudo     0  zero.pseudo
#&gt; 57   LT2        amin     1 Clausiliidae
#&gt; 58   LT2        pvic     1    Zonitidae
#&gt; 59   LT3        amin     5 Clausiliidae
#&gt; 60   LT3        dper     1    Zonitidae
#&gt; 61   LT3        pinc     1    Zonitidae
#&gt; 62   LT3        pvic     1 Clausiliidae
#&gt; 63   LT3        tuni     2    Zonitidae
#&gt; 64   RQ1        amin     3   Ellobiidae
#&gt; 65   RQ1        ccer     1    Zonitidae
#&gt; 66   RQ1        clam     1    Helicidae
#&gt; 67   RQ1        cort     1  Euconulidae
#&gt; 68   RQ1        dper     3  Valloniidae
#&gt; 69   RQ1        ffau     2  Euconulidae
#&gt; 70   RQ1        hobv     2   Ellobiidae
#&gt; 71   RQ1        ogla     1    Helicidae
#&gt; 72   RQ1        ppyg     5   Ellobiidae
#&gt; 73   RQ1        vidi     4    Helicidae
#&gt; 74   RQ2        amin     7    Zonitidae
#&gt; 75   RQ2        bbip     4    Zonitidae
#&gt; 76   RQ2        ctri     7    Zonitidae
#&gt; 77   RQ2        dbre     1 Clausiliidae
#&gt; 78   RQ2        dper     6    Zonitidae
#&gt; 79   RQ2        estr     3 Clausiliidae
#&gt; 80   RQ2        ffau     2    Helicidae
#&gt; 81   RQ2        hobv     9    Zonitidae
#&gt; 82   RQ2        mobs     2  Valloniidae
#&gt; 83   RQ2        odol    13    Helicidae
#&gt; 84   RQ2        ogla     3 Clausiliidae
#&gt; 85   RQ2        ppyg    28    Zonitidae
#&gt; 86   RQ2        pvic     1 Clausiliidae
#&gt; 87   RQ2        tuni     2    Zonitidae
#&gt; 88   RQ2        vcos     2  Valloniidae
#&gt; 89   RQ2        vidi     7 Clausiliidae
#&gt; 90   RQ3        aacu     2    Helicidae
#&gt; 91   RQ3        amin    13 Endodontidae
#&gt; 92   RQ3        bbip     1    Zonitidae
#&gt; 93   RQ3        ctri    10 Endodontidae
#&gt; 94   RQ3        dbre     3 Clausiliidae
#&gt; 95   RQ3        dper     6    Zonitidae
#&gt; 96   RQ3        eful     2 Endodontidae
#&gt; 97   RQ3        ffau     2    Helicidae
#&gt; 98   RQ3        hobv     2 Endodontidae
#&gt; 99   RQ3        mobs     1    Zonitidae
#&gt; 100  RQ3        ppyg     9 Endodontidae
#&gt; 101  RQ3        pvic     1 Clausiliidae
#&gt; 102  RQ3        vidi    11       Enidae
#&gt; 103  RT1        amin     4    Zonitidae
#&gt; 104  RT1        bbip     3 Clausiliidae
#&gt; 105  RT1        ccer     2    Helicidae
#&gt; 106  RT1        cort     1    Helicidae
#&gt; 107  RT1        dper     1 Clausiliidae
#&gt; 108  RT1        ffau     7    Helicidae
#&gt; 109  RT1        hobv     8    Zonitidae
#&gt; 110  RT1        iiso     6 Clausiliidae
#&gt; 111  RT1        pinc     3    Helicidae
#&gt; 112  RT1        pvic     4 Clausiliidae
#&gt; 113  RT1        tuni     5 Clausiliidae
#&gt; 114  RT2        amin     1  Euconulidae
#&gt; 115  RT2        apur     2   Ellobiidae
#&gt; 116  RT2        bbip     3 Clausiliidae
#&gt; 117  RT2        bcan     1  Valloniidae
#&gt; 118  RT2        cort     1    Helicidae
#&gt; 119  RT2        ctri     1  Euconulidae
#&gt; 120  RT2        dper     2 Clausiliidae
#&gt; 121  RT2        estr     4    Zonitidae
#&gt; 122  RT2        ffau    12    Helicidae
#&gt; 123  RT2        hobv     1  Euconulidae
#&gt; 124  RT2        iiso     8   Ellobiidae
#&gt; 125  RT2        pinc     5    Helicidae
#&gt; 126  RT2        pvic     1   Ellobiidae
#&gt; 127  RT2        tuni     3 Clausiliidae
#&gt; 128  RT2        vidi     2    Zonitidae
#&gt; 129  RT3        amin     5    Helicidae
#&gt; 130  RT3        apur     1    Zonitidae
#&gt; 131  RT3        bbip     5 Clausiliidae
#&gt; 132  RT3        clam     1    Helicidae
#&gt; 133  RT3        ffau     6 Clausiliidae
#&gt; 134  RT3        hobv     4    Helicidae
#&gt; 135  RT3        iiso     1    Zonitidae
#&gt; 136  RT3        pinc     3 Clausiliidae
#&gt; 137  RT3        pvic     3    Zonitidae
#&gt; 138  RT3        tuni     1 Clausiliidae
#&gt; 139  WQ1        amin     3    Helicidae
#&gt; 140  WQ1        bbip     1 Clausiliidae
#&gt; 141  WQ1        bcan     1    Zonitidae
#&gt; 142  WQ1        cort     3       Enidae
#&gt; 143  WQ1        iiso     2 Endodontidae
#&gt; 144  WQ1        pinc     2       Enidae
#&gt; 145  WQ1        ppyg    31    Helicidae
#&gt; 146  WQ1        pvic     1 Endodontidae
#&gt; 147  WQ1        vidi     4 Endodontidae
#&gt; 148  WQ2        amin     4    Helicidae
#&gt; 149  WQ2        bbip     1 Clausiliidae
#&gt; 150  WQ2        ccer     1    Zonitidae
#&gt; 151  WQ2        dper    20 Clausiliidae
#&gt; 152  WQ2        estr     2    Helicidae
#&gt; 153  WQ2        mobs     2 Clausiliidae
#&gt; 154  WQ2        pinc     1    Orculidae
#&gt; 155  WQ2        ppyg    56    Helicidae
#&gt; 156  WQ2        pvic     1    Zonitidae
#&gt; 157  WQ2        tuni     2 Clausiliidae
#&gt; 158  WQ3        amin    10    Helicidae
#&gt; 159  WQ3        bbip     3   Ellobiidae
#&gt; 160  WQ3        estr     1    Helicidae
#&gt; 161  WQ3        ffau     2    Zonitidae
#&gt; 162  WQ3        pinc     1    Zonitidae
#&gt; 163  WQ3        ppyg     5    Helicidae
#&gt; 164  WQ3        vicr     1  Valloniidae
#&gt; 165  WQ3        vidi     1    Helicidae
#&gt; 166  WT1        amin     1 Clausiliidae
#&gt; 167  WT1        cort     1    Helicidae
#&gt; 168  WT1        estr     1  Valloniidae
#&gt; 169  WT1        ffau     1    Helicidae
#&gt; 170  WT1        tuni     1    Zonitidae
#&gt; 171  WT2        amin     2       Enidae
#&gt; 172  WT2        apur     1    Helicidae
#&gt; 173  WT2        bbip     1 Endodontidae
#&gt; 174  WT2        dper     2 Endodontidae
#&gt; 175  WT3        amin     4    Orculidae
#&gt; 176  WT3        ffau     1    Helicidae
#&gt; 177  WT3        vidi     1    Zonitidae</div><div class='input'><span class='co'>## Example for non-integer data</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>xtab</span>
<span class='va'>y</span><span class='op'>[</span><span class='va'>y</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span> <span class='op'>&lt;-</span>  <span class='va'>y</span><span class='op'>[</span><span class='va'>y</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>0.123</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mefa.html'>mefa</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
<span class='fu'>melt</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     samp        taxa  count        segm
#&gt; 1    DQ1        amin  4.123   undefined
#&gt; 2    DQ1        ctri  2.123   undefined
#&gt; 3    DQ1        dper  2.123   undefined
#&gt; 4    DQ1        estr  1.123   undefined
#&gt; 5    DQ1        vidi  9.123   undefined
#&gt; 6    DQ2        amin  4.123   undefined
#&gt; 7    DQ2        apur  1.123   undefined
#&gt; 8    DQ2        ctri 20.123   undefined
#&gt; 9    DQ2        dper  2.123   undefined
#&gt; 10   DQ2        druf  2.123   undefined
#&gt; 11   DQ2        ppyg  1.123   undefined
#&gt; 12   DQ2        vidi  9.123   undefined
#&gt; 13   DQ3        amin  3.123   undefined
#&gt; 14   DQ3        apur  1.123   undefined
#&gt; 15   DQ3        hobv  3.123   undefined
#&gt; 16   DQ3        vidi  2.123   undefined
#&gt; 17   DT1        amin  1.123   undefined
#&gt; 18   DT1        bcan  1.123   undefined
#&gt; 19   DT1        dper  1.123   undefined
#&gt; 20   DT1        estr  1.123   undefined
#&gt; 21   DT1        hobv  1.123   undefined
#&gt; 22   DT1        mbor  5.123   undefined
#&gt; 23   DT1        pvic  1.123   undefined
#&gt; 24   DT2        amin  2.123   undefined
#&gt; 25   DT2        apur  1.123   undefined
#&gt; 26   DT2        bbip  1.123   undefined
#&gt; 27   DT2        clam  2.123   undefined
#&gt; 28   DT2        dper  1.123   undefined
#&gt; 29   DT2        druf  1.123   undefined
#&gt; 30   DT2        estr  1.123   undefined
#&gt; 31   DT2        hobv  1.123   undefined
#&gt; 32   DT2        tuni  1.123   undefined
#&gt; 33   DT2        vidi  2.123   undefined
#&gt; 34   DT3        amin  3.123   undefined
#&gt; 35   DT3        bbip  1.123   undefined
#&gt; 36   DT3        hobv  6.123   undefined
#&gt; 37   DT3        pvic  1.123   undefined
#&gt; 38   DT3        vidi  2.123   undefined
#&gt; 39   LQ1        aacu  1.123   undefined
#&gt; 40   LQ1        amin  3.123   undefined
#&gt; 41   LQ1        dper  1.123   undefined
#&gt; 42   LQ1        ffau  1.123   undefined
#&gt; 43   LQ1        ppyg 28.123   undefined
#&gt; 44   LQ2        aacu  1.123   undefined
#&gt; 45   LQ2        amin  1.123   undefined
#&gt; 46   LQ2        dper  1.123   undefined
#&gt; 47   LQ2        ppyg 13.123   undefined
#&gt; 48   LQ2        pvic  1.123   undefined
#&gt; 49   LQ3        amin  2.123   undefined
#&gt; 50   LQ3        apur  1.123   undefined
#&gt; 51   LQ3        bbip  1.123   undefined
#&gt; 52   LQ3        ccer  1.123   undefined
#&gt; 53   LQ3        dper  7.123   undefined
#&gt; 54   LQ3        ppyg 69.123   undefined
#&gt; 55   LQ3        pvic  1.123   undefined
#&gt; 56   LT1 zero.pseudo  0.000 zero.pseudo
#&gt; 57   LT2        amin  1.123   undefined
#&gt; 58   LT2        pvic  1.123   undefined
#&gt; 59   LT3        amin  5.123   undefined
#&gt; 60   LT3        dper  1.123   undefined
#&gt; 61   LT3        pinc  1.123   undefined
#&gt; 62   LT3        pvic  1.123   undefined
#&gt; 63   LT3        tuni  2.123   undefined
#&gt; 64   RQ1        amin  3.123   undefined
#&gt; 65   RQ1        ccer  1.123   undefined
#&gt; 66   RQ1        clam  1.123   undefined
#&gt; 67   RQ1        cort  1.123   undefined
#&gt; 68   RQ1        dper  3.123   undefined
#&gt; 69   RQ1        ffau  2.123   undefined
#&gt; 70   RQ1        hobv  2.123   undefined
#&gt; 71   RQ1        ogla  1.123   undefined
#&gt; 72   RQ1        ppyg  5.123   undefined
#&gt; 73   RQ1        vidi  4.123   undefined
#&gt; 74   RQ2        amin  7.123   undefined
#&gt; 75   RQ2        bbip  4.123   undefined
#&gt; 76   RQ2        ctri  7.123   undefined
#&gt; 77   RQ2        dbre  1.123   undefined
#&gt; 78   RQ2        dper  6.123   undefined
#&gt; 79   RQ2        estr  3.123   undefined
#&gt; 80   RQ2        ffau  2.123   undefined
#&gt; 81   RQ2        hobv  9.123   undefined
#&gt; 82   RQ2        mobs  2.123   undefined
#&gt; 83   RQ2        odol 13.123   undefined
#&gt; 84   RQ2        ogla  3.123   undefined
#&gt; 85   RQ2        ppyg 28.123   undefined
#&gt; 86   RQ2        pvic  1.123   undefined
#&gt; 87   RQ2        tuni  2.123   undefined
#&gt; 88   RQ2        vcos  2.123   undefined
#&gt; 89   RQ2        vidi  7.123   undefined
#&gt; 90   RQ3        aacu  2.123   undefined
#&gt; 91   RQ3        amin 13.123   undefined
#&gt; 92   RQ3        bbip  1.123   undefined
#&gt; 93   RQ3        ctri 10.123   undefined
#&gt; 94   RQ3        dbre  3.123   undefined
#&gt; 95   RQ3        dper  6.123   undefined
#&gt; 96   RQ3        eful  2.123   undefined
#&gt; 97   RQ3        ffau  2.123   undefined
#&gt; 98   RQ3        hobv  2.123   undefined
#&gt; 99   RQ3        mobs  1.123   undefined
#&gt; 100  RQ3        ppyg  9.123   undefined
#&gt; 101  RQ3        pvic  1.123   undefined
#&gt; 102  RQ3        vidi 11.123   undefined
#&gt; 103  RT1        amin  4.123   undefined
#&gt; 104  RT1        bbip  3.123   undefined
#&gt; 105  RT1        ccer  2.123   undefined
#&gt; 106  RT1        cort  1.123   undefined
#&gt; 107  RT1        dper  1.123   undefined
#&gt; 108  RT1        ffau  7.123   undefined
#&gt; 109  RT1        hobv  8.123   undefined
#&gt; 110  RT1        iiso  6.123   undefined
#&gt; 111  RT1        pinc  3.123   undefined
#&gt; 112  RT1        pvic  4.123   undefined
#&gt; 113  RT1        tuni  5.123   undefined
#&gt; 114  RT2        amin  1.123   undefined
#&gt; 115  RT2        apur  2.123   undefined
#&gt; 116  RT2        bbip  3.123   undefined
#&gt; 117  RT2        bcan  1.123   undefined
#&gt; 118  RT2        cort  1.123   undefined
#&gt; 119  RT2        ctri  1.123   undefined
#&gt; 120  RT2        dper  2.123   undefined
#&gt; 121  RT2        estr  4.123   undefined
#&gt; 122  RT2        ffau 12.123   undefined
#&gt; 123  RT2        hobv  1.123   undefined
#&gt; 124  RT2        iiso  8.123   undefined
#&gt; 125  RT2        pinc  5.123   undefined
#&gt; 126  RT2        pvic  1.123   undefined
#&gt; 127  RT2        tuni  3.123   undefined
#&gt; 128  RT2        vidi  2.123   undefined
#&gt; 129  RT3        amin  5.123   undefined
#&gt; 130  RT3        apur  1.123   undefined
#&gt; 131  RT3        bbip  5.123   undefined
#&gt; 132  RT3        clam  1.123   undefined
#&gt; 133  RT3        ffau  6.123   undefined
#&gt; 134  RT3        hobv  4.123   undefined
#&gt; 135  RT3        iiso  1.123   undefined
#&gt; 136  RT3        pinc  3.123   undefined
#&gt; 137  RT3        pvic  3.123   undefined
#&gt; 138  RT3        tuni  1.123   undefined
#&gt; 139  WQ1        amin  3.123   undefined
#&gt; 140  WQ1        bbip  1.123   undefined
#&gt; 141  WQ1        bcan  1.123   undefined
#&gt; 142  WQ1        cort  3.123   undefined
#&gt; 143  WQ1        iiso  2.123   undefined
#&gt; 144  WQ1        pinc  2.123   undefined
#&gt; 145  WQ1        ppyg 31.123   undefined
#&gt; 146  WQ1        pvic  1.123   undefined
#&gt; 147  WQ1        vidi  4.123   undefined
#&gt; 148  WQ2        amin  4.123   undefined
#&gt; 149  WQ2        bbip  1.123   undefined
#&gt; 150  WQ2        ccer  1.123   undefined
#&gt; 151  WQ2        dper 20.123   undefined
#&gt; 152  WQ2        estr  2.123   undefined
#&gt; 153  WQ2        mobs  2.123   undefined
#&gt; 154  WQ2        pinc  1.123   undefined
#&gt; 155  WQ2        ppyg 56.123   undefined
#&gt; 156  WQ2        pvic  1.123   undefined
#&gt; 157  WQ2        tuni  2.123   undefined
#&gt; 158  WQ3        amin 10.123   undefined
#&gt; 159  WQ3        bbip  3.123   undefined
#&gt; 160  WQ3        estr  1.123   undefined
#&gt; 161  WQ3        ffau  2.123   undefined
#&gt; 162  WQ3        pinc  1.123   undefined
#&gt; 163  WQ3        ppyg  5.123   undefined
#&gt; 164  WQ3        vicr  1.123   undefined
#&gt; 165  WQ3        vidi  1.123   undefined
#&gt; 166  WT1        amin  1.123   undefined
#&gt; 167  WT1        cort  1.123   undefined
#&gt; 168  WT1        estr  1.123   undefined
#&gt; 169  WT1        ffau  1.123   undefined
#&gt; 170  WT1        tuni  1.123   undefined
#&gt; 171  WT2        amin  2.123   undefined
#&gt; 172  WT2        apur  1.123   undefined
#&gt; 173  WT2        bbip  1.123   undefined
#&gt; 174  WT2        dper  2.123   undefined
#&gt; 175  WT3        amin  4.123   undefined
#&gt; 176  WT3        ffau  1.123   undefined
#&gt; 177  WT3        vidi  1.123   undefined</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Solymos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


